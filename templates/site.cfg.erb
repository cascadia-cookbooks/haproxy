# Managed by Chef, changes will be overwritten

# Configuration for frontend: <%= @id %>

frontend <%= @id %>
    bind *:<%= @frontend[:bind_port] || 80 %>

    acl host_<%= @id %> hdr(host) -i<% @frontend[:target_urls].each do |url| %> <%= url %><% end %>
    use_backend <%= @id %>_cluster if host_<%= @id %>

backend <%= @id %>_cluster
    balance <%= @backend[:balance_strategy] || 'roundrobin' %>
    mode tcp
<% @backend[:servers].each do |server| %>
    server <%= server[:id] %> <%= server[:address] %>:<%= server[:port] || 80 %> check
<% end %>
